{% extends 'base.html' %} {% load static %} {% block content %}

<section class="section-content padding-y bg-light">
  {% include 'includes/alerts.html' %}
  <div class="container">
    <div class="row">
      {% include 'includes/dashboard_sidebar.html' %}
      <main class="col-md-9">
        <article class="card shadow-sm mb-4">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-md-8">
                <h4 class="card-title mb-1">Welcome back, {{ user.first_name }}!</h4>
                <p class="text-muted mb-0">Manage your orders and account details.</p>
              </div>
              <div class="col-md-4 text-md-end mt-3 mt-md-0">
                <span class="badge bg-success p-2 px-3 rounded-pill">Active Account</span>
              </div>
            </div>
          </div>
        </article>

        <div class="row">
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-body text-center p-4">
                <div class="feature-icon-small mb-3">
                  <i class="fa fa-shopping-bag"></i>
                </div>
                <h5 class="card-title">Total Orders</h5>
                <h2 class="display-4 fw-bold text-primary mb-3">{{orders_count}}</h2>
                <a href="{% url 'my_orders' %}" class="btn btn-outline-primary rounded-pill px-4">View Orders</a>
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-body text-center p-4">
                <div class="mb-3 position-relative d-inline-block">
                  {% if userprofile.profile_picture and userprofile.profile_picture.name %}
                  <img
                    src="{{ userprofile.profile_picture.url }}"
                    alt="User Profile Picture"
                    width="100"
                    height="100"
                    class="rounded-circle border border-3 border-white shadow-sm"
                    style="object-fit: cover;"
                  />
                  {% else %}
                  <img
                    src="{% static 'images/default_profile.png' %}"
                    alt="User Profile Picture"
                    width="100"
                    height="100"
                    class="rounded-circle border border-3 border-white shadow-sm"
                    style="object-fit: cover;"
                    onerror="this.src='/media/default/user-default.png';"
                  />
                  {% endif %}
                  <a href="{% url 'edit_profile' %}" class="position-absolute bottom-0 end-0 bg-white rounded-circle p-1 shadow-sm text-dark" style="width: 32px; height: 32px; line-height: 24px;">
                    <i class="fa fa-pencil-alt small"></i>
                  </a>
                </div>
                
                <h5 class="mb-1">{{ user.full_name }}</h5>
                <p class="text-muted mb-2">{{ user.email }}</p>
                <p class="mb-3"><i class="fa fa-phone-alt me-2 text-muted"></i>{{ user.phone_number }}</p>
                
                <a href="{% url 'edit_profile' %}" class="btn btn-sm btn-light rounded-pill">Edit Profile</a>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
</section>

<style>
  .feature-icon-small {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    color: white;
    font-size: 24px;
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
  }
</style>

{% endblock %}
